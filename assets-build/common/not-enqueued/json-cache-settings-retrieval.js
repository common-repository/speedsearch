!function(){"use strict";function e(e,t){const s="object"==typeof t&&null!==t?JSON.stringify(t):t;try{sessionStorage.setItem(e,s)}catch(t){!function(){for(const e of Object.keys(sessionStorage).filter((e=>e.startsWith("speedsearch-cache-"))))sessionStorage.removeItem(e)}(),sessionStorage.setItem(e,s)}}function t(e){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e,{passive:!0}):e()}window.speedsearch_debug={fetchTimestampsAfter:[],generateTimestamp:function(){const e=String(Date.now()),t=e.slice(0,-3)+"."+e.slice(-3);return t.slice(0,-6)+"."+t.slice(-6)}},t((function(){window.speedsearch_debug.DOMContentLoadedTimestamps=speedsearch_debug.generateTimestamp()})),function(){async function t(){const e=await fetch(`/speedsearch/${String(Math.random()).replace(".","")}?${new URLSearchParams({plugin:"speedsearch",action:"get_server_time"}).toString()}`,{method:"GET",credentials:"same-origin"}),t=await e.json(),s=parseInt(t.server_time);window.speedsearch_updateTimeDeltaWithTheServer(s)}window.speedsearch_timeDeltaWithTheServerInSec=parseInt(sessionStorage.getItem("speedsearch-time-delta-with-the-server")),window.speedsearch_updateTimeDeltaWithTheServer=function(t){const s=Math.round(Date.now()/1e3);window.speedsearch_timeDeltaWithTheServerInSec=s-t,e("speedsearch-time-delta-with-the-server",window.speedsearch_timeDeltaWithTheServerInSec)},window.speedsearch_getCurrentServerTime=function(){return Math.round(Date.now()/1e3)-window.speedsearch_timeDeltaWithTheServerInSec},null===sessionStorage.getItem("speedsearch-time-delta-with-the-server")&&t(),setInterval(t,3e5)}(),function(){let s;function n(){window.speedsearch_afterJSONCacheSettingsRetrieved||(t((()=>{window.speedsearchLoaded=!0,document.dispatchEvent(new Event("speedsearchLoaded"))})),window.speedsearch_afterJSONCacheSettingsRetrieved=!0)}function a(){const t=Math.round(Date.now()/1e3)-window.speedsearch_timeDeltaWithTheServerInSec,n=60*window.speedsearch_JSONCacheSettings.flushInterval,i=window.speedsearch_JSONCacheSettings.lastFlushTime+n,r=i-t;clearTimeout(s),s=setTimeout((function(){window.speedsearch_JSONCacheSettings.lastFlushTime=i,e("speedsearch-json-cache-settings",JSON.stringify(window.speedsearch_JSONCacheSettings)),a()}),Math.max(1e3*r,0))}async function i(){const t=await fetch(`${speedsearch_filesDir}${speedsearch_jsonCacheSettingsFilename}`);if(isNaN(window.speedsearch_timeDeltaWithTheServerInSec)){const e=t.headers.get("Date");if(e){const t=Math.round(Date.parse(new Date(Date.parse(e)).toUTCString())/1e3);window.speedsearch_updateTimeDeltaWithTheServer(t)}else window.speedsearch_timeDeltaWithTheServerInSec=0}window.speedsearch_JSONCacheSettings=await t.json(),e("speedsearch-json-cache-settings",JSON.stringify(window.speedsearch_JSONCacheSettings)),e("speedsearch-json-cache-settings-last-fetch-time",Date.now()),window.speedsearch_debug.fetchTimestampsAfter.push({get_json_responses_settings:speedsearch_debug.generateTimestamp()}),a(),n()}const r=sessionStorage.getItem("speedsearch-json-cache-settings");if(null===r)i();else{const e=parseInt(sessionStorage.getItem("speedsearch-json-cache-settings-last-fetch-time")),t=Date.now()-18e4;isNaN(window.speedsearch_timeDeltaWithTheServerInSec)&&(window.speedsearch_timeDeltaWithTheServerInSec=0),window.speedsearch_JSONCacheSettings=JSON.parse(r),a(),n(),e<t&&i()}}()}();